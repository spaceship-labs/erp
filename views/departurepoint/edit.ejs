<script type='text/javascript'>
    window.dp = <%- JSON.stringify(dp) %>;
    window.points = <%- JSON.stringify(points) %>;
</script>
<div ng-controller='dpEditCTL'>
    <div class='row-fluid'>
        <div class="span6">
            <div class="widgetbox personal-information ng-form-helper">
                <h4 class="widgettitle"><%= __('departure_points_3') %> <span ng-click="saveDP()" class="fa icon fa-save"></span></h4>
                <form class="form stdform stdform2 widgetcontent nopadding" ng-submit="saveDP()">
                    <p>
                        <label for="dp_name">Nombre</label>
                        <span class="field">
                            <input name="dp_name" ng-model="newdp.name" type="text">
                        </span>
                    </p>
                    <p>
                        <label for="dp_description">Descripci√≥n</label>
                        <span class="field">
                            <input name="dp_description" ng-model="newdp.description" type="text">
                        </span>
                    </p>
                    <p>
                        <label for="dp_type">Tipo</label>
                        <span class="field">
                            <select name="dp_type" class="form-control" ng-model="newdp.type" ng-options="t.key as t.name for t in types"></select>
                        </span>
                    </p>
                    <p>
                        <label for="dp_location">Ciudad</label>
                        <span class="field">
                            <select name="dp_location" class="form-control" ng-model="newdp.location" ng-options="p.id as p.name for p in points"></select>
                        </span>
                    </p>
                    <p ng-if="newdp.type=='hotel'&&newdp.location">
                        <label for="dp_hotel">Hotel</label>
                        <span class="field">
                            <select name="dp_hotel" class="form-control" ng-model="newdp.hotel" ng-options="h.id as h.name for h in getItems(newdp.location,'hotels')"></select>
                        </span>
                    </p>
                    <p ng-if="newdp.type=='zone'&&newdp.location">
                        <label for="dp_zone">Zona</label>
                        <span class="field">
                            <select name="dp_zone" class="form-control" ng-model="newdp.zone" ng-options="z.id as z.name for z in getItems(newdp.location,'zones')"></select>
                        </span>
                    </p>
                </form>
            </div>
        </div>
    </div>
    <div class='row-fluid'>
        <div class="span12">
            <leaflet width="100%" height="350px" markers='markers' center='center' layers="layers"></leaflet>
        </div>
    </div>
    <br/>
</div>